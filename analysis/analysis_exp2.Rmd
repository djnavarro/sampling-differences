---
title: "Analysis: Experiment 2"
author: "Danielle Navarro"
date: "21-Sep-2020"
output:
  rmarkdown::html_document:
    theme: flatly
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r packages, message=FALSE}
library(tidyverse)
library(scico)
source(here::here("models","sampling_frames_model.R"))
source(here::here("analysis","helpers.R"))
```

## 0. Getting started

```{r, message=FALSE}
exp_data_file <- "exp2.csv"
human <- read_csv(here::here("data", exp_data_file)) %>%
  group_by(sample_size, sampling_frame, test_item) %>%
  summarise(response = mean(response)/10, source = "human") %>% 
  ungroup()

human
```

```{r, message=FALSE}
model <- sampling_frames_model(theta = 1, smooth_weight = 1, mean_weight = 2) %>% 
  mutate(source = "model")

model
```


## Comparing the model to the aggregated human data

How closely does the model approximate the human data? The plots here are constructed with no changes at all to the predictions from experiment 1. (Except obviously to drop model predictions for sample size 2)

```{r, message=FALSE}
model <- filter(model, sample_size != 2)
dat <- bind_rows(model, human)
plot_curves(dat) 
```

```{r, message=FALSE}
plot_points(dat)
```


## 2. Do individuals show the qualitative patterns?

Individual subject patterns. Because experiment 2 only had sample sizes of 8 and 20, only the starred tests exist

- group A:
- 1  (test items 1-2) > (test items 3-6) overall *
- 2  (test items 1-2) > (test items 3-6) category *
- 3  (test items 1-2) > (test items 3-6) property *

- group B:
- 1  - (ss 20 > ss 8)  test items 1-2 category *
- 2  - (ss 20 > ss 2)  test items 1-2 category
- 3  - (ss 8 > ss 2)   test items 1-2 category

- group C: 
- 1  - (ss 20 > ss 8)  test items 1-2 property *
- 2  - (ss 20 > ss 2)  test items 1-2 property
- 3  - (ss 8 > ss 2)   test items 1-2 property

- group D:
- 1  - (ss 20 > ss 8)  test items 3-6 category *
- 2  - (ss 20 > ss 2)  test items 3-6 category
- 3  - (ss 8 > ss 2)   test items 3-6 category 

- group E:
- 1  - (ss 20 < ss 8)  test items 3-6 property *
- 2  - (ss 20 < ss 2)  test items 3-6 property 
- 3  - (ss 8 < ss 2)   test items 3-6 property 

```{r, message=FALSE, fig.height=8, fig.width=6}
plot_constraint_checks(exp_data_file)
```


## 3. Exploring the individual differences

Example subject:

```{r, message = FALSE}
read_csv(here::here("data", exp_data_file))  %>%
  mutate(test_type = ifelse(test_item %in% 1:2, "near", "far")) %>%
  group_by(id, test_type, sample_size, sampling_frame) %>%
  summarise(response = mean(response/10)) %>%
  ungroup() %>%
  pivot_wider(
    id_cols = c(id, test_type, sample_size), 
    names_from = sampling_frame, 
    values_from = response
  ) %>%
  filter(id == 1)
```  


The tadpole plots:

```{r, message=FALSE}
p <- plot_individual_differences(exp_data_file)
p[[1]]
```


Offset:

```{r, message=FALSE}
p[[2]]
```


